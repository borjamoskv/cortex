# CORTEX v4 ‚Äî The Sovereign Ledger Architecture

CORTEX is a persistent memory infrastructure designed for autonomous AI agents. Version 4.0 ("Sovereign") transition from a monolithic engine to a modular, mixin-based orchestration layer with a cryptographically chained transaction ledger.

## üèóÔ∏è Core Components

### 1. Modular Engine (`cortex.engine`)
The engine is composed of specialized mixins that aggregate capabilities into the main `CortexEngine` class:
- **StoreMixin**: Manages logic for storing facts, updates, deprecations, and "ghost" (unresolved) entities.
- **QueryMixin**: Implements semantic search (via `sqlite-vec`), temporal history lookups, and state reconstruction.
- **ConsensusMixin**: Orchestrates the Reputation-Weighted Consensus (RWC) protocols for verifying memories.

### 2. Transaction Ledger (`cortex.ledger`)
Every modification to the CORTEX state is recorded in an append-only transaction table.
- **Hash Chaining**: Each transaction includes a SHA-256 hash of its contents and the `prev_hash` of the preceding record, forming a verifiable chain.
- **Merkle Checkpoints**: Periodic snapshots of the ledger state verified via Merkle trees to ensure long-term integrity.

### 3. Sync & Persistence Layer (`cortex.sync`)
CORTEX acts as the Single Source of Truth, synchronizing its state with the local filesystem (`~/.agent/memory/`) for backward compatibility with older agents.
- **Bi-directional Sync**: Detects changes in JSON/JSONL files using SHA-256 file hashes.
- **Atomic Writeback**: Ensures that exports from DB to disk never leave the system in an inconsistent state.

### 4. Search & Embeddings (`cortex.search`)
- **Semantic Search**: Powered by `sqlite-vec` using 384-dimensional embeddings (SentenceTransformers).
- **Hybrid Retrieval**: Combines vector similarity with traditional FTS (Full Text Search) for maximum accuracy.

## üß¨ Consensus Mechanisms

### Reputation-Weighted Consensus v2 (RWC)
CORTEX supports distributed verification of facts across a swarm of agents:
- **Reputation Score**: Agents earn weight based on historical verification accuracy.
- **Staking**: (Optional) Agents stake assets/reputation on their votes.
- **Decay Factor**: Weights older verification less than recent ones to account for evolving context.

## üåë Aesthetic & Identity
CORTEX follows the **Industrial Noir** aesthetic:
- **Palette**: Abyssal black, laser green, industrial gold.
- **Vibe**: Sovereign, immutable, precise.

---
*Blueprint generated by MOSKV-1 v5 (The Sovereign) via MEJORAlo Protocol.*
